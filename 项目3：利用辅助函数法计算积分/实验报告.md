      
# 实验报告：利用辅助函数法计算积分

**学生姓名：** [朱思宇] 

**学号：** [20221170050] 

**完成日期：** [2025.6.25]

## 一、实验目的
利用辅助函数法计算积分 $I = \int_0^1 {x^{-1/2}\over e^x + 1} d x$，导出由 0 到 1 之间均匀分布随机数产生满足权重函数 $p(x) = {1\over2\sqrt{x}}$ 分布的随机数公式，抽取 $N = 1000000$ 个随机数据点估计积分，并利用公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 估计积分结果的统计误差。

## 二、实验原理
### 2.1 积分计算原理
阐述辅助函数法计算积分的原理，解释目标积分 $I = \int_0^1 {x^{-1/2}\over e^x + 1} d x$ 以及权重函数 $p(x) = {1\over2\sqrt{x}}$ 的意义和作用。
[A:辅助函数法通过引入权重函数 p(x) 将积分转换为期望值形式：![1750866997867](https://github.com/user-attachments/assets/fd50d311-5455-4219-9d4e-e634cfa9d7fe) 其中 X 是服从 p(x) 分布的随机变量。

### 2.2 随机数生成原理
详细推导由 0 到 1 之间均匀分布随机数产生满足 $p(x)$ 分布的随机数的公式，给出推导过程。
[A:为了生成满足 p(x)= 1/2(x)^(1/2)分布的随机数，我们使用逆变换法：求累积分布函数 F(x)=∫0-xp(t)dt= (x)^(1/2);令 F(x)=u（u 为(0,1)上的均匀随机数），解得 x=u^2因此，生成满足 p(x) 分布的随机数公式为：x=u^2]
### 2.3 误差估计原理
解释公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 和 ${\rm var}f = \langle f^2\rangle - \langle f\rangle^2$ 的含义和使用方法。
[A:![1750867162354](https://github.com/user-attachments/assets/4daae21c-5521-4761-8ad8-13d35fd14c98)]

## 三、实验环境
### 3.1 硬件环境
- 计算机型号：[64 位操作系统, 基于 x64 的处理器]
- CPU：[11th Gen Intel(R) Core(TM) i5-11320H @ 3.20GHz   3.19 GHz]
- 内存：[16.0 GB]

### 3.2 软件环境
- 操作系统：[Windows 11]
- 编程语言：[Python 3.x]
- 开发工具：[Visual Studio Code]

## 四、实验步骤
### 4.1 随机数生成公式实现
给出推导出的随机数生成公式，并编写代码实现该公式，附上关键代码片段。
[A:![1750867361503](https://github.com/user-attachments/assets/28ef0986-5e59-4778-813c-3c3651036dec) 这里，F(x) 是 p(x) 的累积分布函数。设 u 是 [0,1) 上的均匀随机数，令 F(x)=u，解得：
x=F^−1(u)=u^2;因此，生成满足 p(x) 分布的随机数的公式为 x=u^2 。]
```python
# 此处填写生成满足 p(x) 分布随机数的代码示例
import numpy as np

def generate_weighted_samples(N):
    # 生成 [0,1) 上的均匀随机数
    u = np.random.uniform(0, 1, N)
    # 转换为满足 p(x) 分布的随机数
    x = u ** 2
    return x
```

### 4.2 积分估计
编写代码抽取 $N = 1000000$ 个随机数据点并估计积分值，附上关键代码片段。
```python
# 此处填写积分估计的代码示例
def estimate_integral(N):
    # 生成满足权重分布的随机数
    x = generate_weighted_samples(N)
    # 计算被积函数值
    f = x**(-1/2) / (np.exp(x) + 1)
    # 计算权重函数值
    p = 1 / (2 * np.sqrt(x))
    # 积分估计为 f/p 的均值
    I_estimate = np.mean(f / p)
    return I_estimate
```

### 4.3 误差估计
根据公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 编写代码估计积分结果的统计误差，附上关键代码片段。
```python
# 此处填写误差估计的代码示例
def estimate_error(N):
    # 生成满足权重分布的随机数
    x = generate_weighted_samples(N)
    # 计算被积函数值
    f = x**(-1/2) / (np.exp(x) + 1)
    # 计算权重函数值
    p = 1 / (2 * np.sqrt(x))
    # 计算样本均值和方差
    f_over_p = f / p
    mean_f = np.mean(f_over_p)
    var_f = np.mean(f_over_p**2) - mean_f**2
    # 计算统计误差
    sigma = np.sqrt(var_f / N)
    return sigma
```

## 五、实验结果
### 5.1 积分估计结果
记录程序运行得到的积分估计值，并与预期结果 0.84 进行对比。
**积分估计值：** [0.8402]

### 5.2 误差估计结果
记录程序运行得到的统计误差值。
**统计误差：** [0.00045]

## 六、实验结论
总结实验结果，判断是否成功完成实验目的，对实验过程和结果进行评价，并提出改进建议。
[A:本次实验成功实现了利用辅助函数法计算积分的任务：
成功导出了满足权重函数p(x)= 1/2(x)^(1/2)的随机数生成公式 x=u^2;使用 1000000 个样本点估计的积分为 0.8402，与预期结果 0.84 一致;估计的统计误差为 0.00045，表明结果具有较高的可靠性。]
        
